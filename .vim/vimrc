" local plugins
call plug#load('proj')
call plug#load('find')
call plug#load('browser')
call plug#load('comment')
call plug#load('mark')
call plug#load('pair')
call plug#load('scroll')
call plug#load('search')
call plug#load('space')
call plug#load('mode')
call plug#load('trim')
call plug#load('mru')
call plug#load('utils')

" external plugins
call plug#remote('w0rp/ale')
call plug#remote('mhinz/vim-signify')

call ft#detect('Justfile', 'make')
call ft#detect('*.glsl', 'glsl')
call ft#detect('*.toml', 'toml')
call ft#detect('*.graphql', 'graphql')
call ft#detect('*.h', 'c')
call ft#detect('*.dt', 'dirty')
call ft#detect('*.fish', 'fish')

" options
set magic
set nonumber
set nowrap
set showbreak=..
set spelllang=en
set nofoldenable
set mouse=a
set encoding=utf-8
set termencoding=utf-8
set fileencodings=utf-8,gbk
set scroll=8
set scrolloff=3
set cursorline
set noexpandtab
set shiftwidth=4
set tabstop=4
set ttimeoutlen=0
set hlsearch
set incsearch
set ignorecase
set nowrapscan
set whichwrap=h,l,<,>
set list
set autoindent
set noswapfile
set laststatus=2
set showtabline=2
set backspace=2
set signcolumn=yes
set noshowmode
set signcolumn=yes
set wildignore=*/.git/*,*/.svn/*,*/.cache/*,*/.tmp/*,*/node_modules/*,*/.tup/*
set wildignore=.git,.svn,.cache,.tmp,node_modules,.tup
set wildignore+=.DS_Store
set wildignore+=.tags,*.map
set wildignore+=*.so,*.o,*.out,*.swp,*.exe,*.elf,*.hex,*.dll,*~
exec 'set listchars=tab:\|\ '
syntax on
colorscheme super

" movement
noremap <silent> k gk
noremap <silent> j gj
noremap <silent> <up> gk
noremap <silent> <down> gj
noremap <silent> h h
noremap <silent> l l
noremap <silent> <m-h> b
noremap <silent> <m-l> e
inoremap <silent> <up> <c-x><c-y>
inoremap <silent> <down> <c-x><c-e>
noremap <silent> % %
noremap <silent> ^ gg
noremap <silent> $ G

" buffer
nnoremap <silent> ` <c-^>
tnoremap <silent> ` <c-\><c-n><c-^>
nnoremap <silent> - <cmd>silent! bprev<cr>
nnoremap <silent> = <cmd>silent! bnext<cr>
nnoremap <silent> <M-q> <cmd>silent! bprev<cr>
tnoremap <silent> <M-q> <cmd>silent! bprev<cr>
nnoremap <silent> <M-e> <cmd>silent! bnext<cr>
tnoremap <silent> <M-e> <cmd>silent! bnext<cr>

" edit
nnoremap <silent> > A
nnoremap <silent> < I
vnoremap <silent> > <esc>`>a
vnoremap <silent> < <esc>`<i
nnoremap <silent> <return> a
vnoremap <silent> <return> s
" nnoremap <silent> <m-return> A<return>yo<bs><bs><esc>
inoremap <silent> <return> <return>yo<bs><bs>
inoremap <silent> <m-return> <esc>mqa<return><esc>`qa<return>
nnoremap <silent> c ci
" cnoremap <m-bs> <c-w>

" undo & redo
nnoremap <silent> u u
nnoremap <silent> o <c-r>

" cut & copy & paste
noremap <silent> p "*P
nnoremap <silent> y "*yy
vnoremap <silent> y mq"*y`>`q
nnoremap <silent> x "*dd
vnoremap <silent> x "*d
noremap <silent> d "_dd<esc>
inoremap <silent> <m-p> <esc>"*pa

" selection
nnoremap <silent> v V
nnoremap <silent> <space> viw
vnoremap <silent> <space> <esc>
vnoremap <silent> v <esc>
nnoremap <silent> <m-v> v

" indent
vnoremap <silent> <tab> >
vnoremap <silent> <bs> <

" misc
nnoremap <silent> w :w<cr>

" plugins
call pair#bind()
call search#bind()
noremap <silent> <m-k> <cmd>ScrollUp<cr>
noremap <silent> <m-j> <cmd>ScrollDown<cr>
nnoremap <silent> <tab> :BrowserToggle<cr>
nnoremap <silent> <m--> :OpenTerm<cr>
nnoremap <silent> <m-=> :OpenFinder<cr>
noremap <silent> / :CommentToggle<cr>
nnoremap <silent> <m-w> :Close<cr>
nnoremap <silent> <m-n> :ALEPrevious<cr>
nnoremap <silent> <m-m> :ALENext<cr>
nnoremap <silent> <f1> :ModeToggle comment<cr>
nnoremap <silent> <f2> :ModeToggle spell<cr>
nnoremap <silent> <f3> :ModeToggle number<cr>
nnoremap <silent> <f4> :ModeToggle wrap<cr>
nnoremap <silent> <f5> :ModeToggle paste<cr>
nnoremap <silent> <f6> :ModeToggle expandtab<cr>
nnoremap <m-f> :Find<cr>
nnoremap <m-g> :Grep<cr>
nnoremap <m-d> :MRU<cr>
nnoremap z :Proj<space>
nnoremap m :!just<space>
